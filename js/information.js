"use strict";$(function(){function e(){var e=w.prop("checked");e&&(localStorage.isDispInfoHint=!0),E.removeClass("display_block").addClass("display_none")}function a(){deviceInfo.isMobile?($("body").removeClass("popup"),$("#common_popup_wrapper").removeClass("display_block").addClass("display_none")):o()}function n(){var e=$("#codename_now").attr("src"),a=$("#name_plate_now").attr("src"),n="";n=a.indexOf("codename_plate_none")>=0?'<img src="'+e+'">':'<img src="'+a+'"><img src="'+e+'">',$("#profile_code_name").html("").html(n),$("#codename_popup_wrapper").removeClass("display_block").addClass("display_none"),deviceInfo.isMobile&&$("body").removeClass("popup")}function o(){$("#common_popup_wrapper").removeClass("display_block").addClass("display_none"),$("#common_popup_close").removeClass("display_none"),$("#common_popup_accept").removeClass("display_block").addClass("display_none"),$("#common_popup_accept").attr("data-value",""),$("#common_popup_decline").removeClass("display_block").addClass("display_none"),$("#popup_container").html("").html("")}function t(e){var a="";return a=e>0?"img/code_name/name/codename_"+("000"+e).slice(-4)+".png":"img/code_name/plate/codename_plate_question.png"}function s(e){var a="";return a=0==e?"img/code_name/plate/codename_plate_none.png":e>0?"img/code_name/plate/codename_plate_"+("000"+e).slice(-4)+".png":"img/code_name/plate/codename_plate_question.png"}function l(){return $("#codename_now").attr("data-id")}function c(){return $("#name_plate_now").attr("data-id")}function d(){$("#codename_popup_wrapper").removeClass("display_none").addClass("display_block"),0==$("#name_plate_now").attr("data-id")&&$("#bt_remove").addClass("disable"),deviceInfo.isMobile?($("body").addClass("popup"),$("body").scrollTop(0)):$("#codename_popup_wrapper").scrollTop(0)}function p(){for(var e="",a=1;a<7;a++)e=$("#codename_rarity"+a).html(),e=e.replace(/\s+/g,""),0==e.length&&$("#codename_rarity"+a).html("所持していません");if(i("codename"),navigator.userAgent.indexOf("iPhone")!=-1){var n=parseInt(navigator.userAgent.toLowerCase().match(/os (\d+)_?/)[1],10);n<=8&&($("#codename_type").prop("disabled",!0),$("#codename_type").css({color:"#777"}))}}function _(){for(var e="",a=1;a<5;a++)e=$("#name_plate_rarity"+a).html(),e=e.replace(/\s+/g,""),0==e.length&&$("#name_plate_rarity"+a).html("所持していません");if(i("name_plate"),navigator.userAgent.indexOf("iPhone")!=-1){var n=parseInt(navigator.userAgent.toLowerCase().match(/os (\d+)_?/)[1],10);n<=8&&($("#name_plate_type").prop("disabled",!0),$("#name_plate_type").css({color:"#777"}))}}function i(e){$("#bt_decide_"+e).addClass("disable"),$("#change_codenameplate_container").removeClass("display_block").addClass("display_none"),$("#change_"+e+"_container").removeClass("display_none").addClass("display_block")}function r(){$(this).hasClass("disable")||($("input[name=codename]:checked").val()?g():u())}function m(){$(this).hasClass("disable")||($("input[name=name_plate]:checked").val()?k($("input[name=name_plate]:checked").val()):y())}function u(){var e="",a=l();e=t(a),v("codename",e,4)}function y(){var e="",a=c();e=s(a),v("name_plate",e,1)}function v(e,a,n){$("#change_codenameplate_container").removeClass("display_none").addClass("display_block"),$("#change_"+e+"_container").removeClass("display_block").addClass("display_none"),$("input[name="+e+"]:checked").prop("checked",!1),$("#"+e+"_type").val(n),$("#"+e+"_sample").attr("src",a),$("#bt_decide_"+e).removeClass("disable"),b(e,n)}function C(){var e=$(this),a=e.attr("value"),n=e.attr("name"),o="",d=0;if("codename"===n?(o=t(a),d=l()):"name_plate"===n&&(o=s(a),d=c()),a==d?$("#bt_decide_"+n).addClass("disable"):$("#bt_decide_"+n).removeClass("disable"),$("#"+n+"_sample").attr("src",o),navigator.userAgent.indexOf("iPhone")!=-1){var p=parseInt(navigator.userAgent.toLowerCase().match(/os (\d+)_?/)[1],10);p<=8&&($("#"+n+"_type").prop("disabled",!1),$("#"+n+"_type").css({color:""}))}}function b(e,a){for(var n=0,o=1;o<=$("#"+e+"_radio ul").length;o++)n=$("#"+e+"_radio ul:nth-child("+o+")").attr("data-rarity"),a==n?$("#"+e+"_radio ul:nth-child("+o+")").removeClass("display_none").addClass("display_block"):$("#"+e+"_radio ul:nth-child("+o+")").removeClass("display_block").addClass("display_none")}function h(){var e=$("#codename_type").prop("selectedIndex"),a=$("#codename_type option:eq("+e+")").val();b("codename",a)}function f(){var e=$("#name_plate_type").prop("selectedIndex"),a=$("#name_plate_type option:eq("+e+")").val();b("name_plate",a)}function g(){var e="",a="",n=$("#codename_now").attr("data-id"),o=$("input[name=codename]:checked").val(),t={uk:uk,codenameId:o};o!=n&&(a=$("#codename_sample").attr("src"),$.ajax({url:"/save_codename",contentType:"application/json",dataType:"json",data:JSON.stringify(t),type:"POST",timeout:2e4,success:function(e){e.status===I.SUCCESS?($("#codename_now").attr("src",a),$("#codename_now").attr("data-id",o),$("#codename_new_1").attr("src",a),R("codename")):S(e.text)},error:function(){e="コードネームの変更に失敗しました。",S(e)}}))}function k(e){var a="",n="",o=$("#name_plate_now").attr("data-id"),t={uk:uk,namePlateId:e};e!=o&&(n=$("#name_plate_sample").attr("src"),$.ajax({url:"/save_name_plate",contentType:"application/json",dataType:"json",data:JSON.stringify(t),type:"POST",timeout:2e4,success:function(a){$("#loading_wrapper").removeClass("display_block").addClass("display_none"),a.status===I.SUCCESS?($("#name_plate_now").attr("src",n),$("#name_plate_now").attr("data-id",e),$("#name_plate_new_1").attr("src",n),e>0&&$("#bt_remove").removeClass("disable"),R("name_plate")):S(a.text)},error:function(){a="ネームプレートの変更に失敗しました。",S(a)}}))}function R(e){$("#change_codenameplate_container").removeClass("display_none").addClass("display_block"),$("#change_"+e+"_container").removeClass("display_block").addClass("display_none"),$("input[name="+e+"]:checked").prop("checked",!1),$("#bt_decide_"+e).removeClass("disable")}function S(e){$("#codename_popup_wrapper").removeClass("display_block").addClass("display_none"),$("#common_popup_wrapper").removeClass("display_none").addClass("display_block"),$("#popup_container").html("").html(e)}var w=$("#hint_checkbox"),O=$("#hint_close"),E=$("#hint_wrapper"),I={SUCCESS:"SUCCESS",SESSION_ERROR:"SESSION_ERROR",PLAY_VERSION_ERROR:"PLAY_VERSION_ERROR",GAME_LOGIN_ERROR:"GAME_LOGIN_ERROR",EXCEPTION_ERROR:"EXCEPTION_ERROR"};localStorage.isDispInfoHint||E.removeClass("display_none").addClass("display_block"),O.on("click",e),$("#common_popup_close").on("click",a),$("#bt_codename_plate_change").on("click",d),$("#bt_codename_plate_cancel").on("click",n),$("#bt_set_codename").on("click",p),$("#bt_decide_codename").on("click",r),$("#bt_cancel_codename").on("click",u),$("#bt_set_name_plate").on("click",_),$("#bt_decide_name_plate").on("click",m),$("#bt_cancel_name_plate").on("click",y),$(":radio").on("change",C),navigator.userAgent.indexOf("iPhone")!=-1?($("#codename_type").focusout(h),$("#name_plate_type").focusout(f)):($("#codename_type").change(h),$("#name_plate_type").change(f))});