"use strict";$(function(){function a(){H=1===G?12:G-1}function n(){N=new BulletinBoardClass(F),N.DisplayDialog()}function e(){N.ClickWantCardNormalButton()}function l(){N.ClickWantCardFoilButton()}function i(){N.ClickReleaseCardNormalButton()}function r(){N.ClickReleaseCardFoilButton()}function t(){N.clickDialogAcceptBtn()}function o(){N.clickDialogDeclineBtn()}function s(){M.CloseDialog()}function _(){$("#contant_frame").animate({scrollTop:0},500)}function c(){A=$("#card_ranking_select").val(),P()}function g(){var a=parseInt($(this).attr("data-value"),10);null!=a&&0!==a&&(E?(E=!1,O.cardDetailDialog(F,!1,!1,!1,E)):(E=!0,O.cardDetailDialog(a,!1,!1,!1,E)))}function k(){if(E){var a=parseInt($("#detail_virus_bt").attr("data-value"),10);O.expandCardImg(a,E,!1)}else O.expandCardImg(F,E,!1)}function d(){var a=$(this).attr("id");"national_bt"===a?($("#national_bt").addClass("enable"),$("#region_bt").removeClass("enable"),$("#location_bt").removeClass("enable"),X.national.length>0?x(X.national):f(K.national)):"month_national_bt"===a?($("#month_national_bt").addClass("enable"),$("#month_region_bt").removeClass("enable"),$("#month_location_bt").removeClass("enable"),Y.national.length>0?R(Y.national):y(K.national)):"last_month_national_bt"===a&&($("#last_month_national_bt").addClass("enable"),$("#last_month_region_bt").removeClass("enable"),$("#last_month_location_bt").removeClass("enable"),Z.national.length>0?T(Z.national):j(K.national))}function m(){var a=$(this).attr("id");"region_bt"===a?ia&&($("#national_bt").removeClass("enable"),$("#region_bt").addClass("enable"),$("#location_bt").removeClass("enable"),X.region.length>0?x(X.region):f(K.region)):"month_region_bt"===a?ia&&($("#month_national_bt").removeClass("enable"),$("#month_region_bt").addClass("enable"),$("#month_location_bt").removeClass("enable"),Y.region.length>0?R(Y.region):y(K.region)):"last_month_region_bt"===a&&ia&&($("#last_month_national_bt").removeClass("enable"),$("#last_month_region_bt").addClass("enable"),$("#last_month_location_bt").removeClass("enable"),Z.region.length>0?T(Z.region):j(K.region))}function p(){var a=$(this).attr("id");"location_bt"===a?ra&&($("#national_bt").removeClass("enable"),$("#region_bt").removeClass("enable"),$("#location_bt").addClass("enable"),X.place.length>0?x(X.place):f(K.place)):"month_location_bt"===a?ra&&($("#month_national_bt").removeClass("enable"),$("#month_region_bt").removeClass("enable"),$("#month_location_bt").addClass("enable"),Y.place.length>0?R(Y.place):y(K.place)):"last_month_location_bt"===a&&ra&&($("#last_month_national_bt").removeClass("enable"),$("#last_month_region_bt").removeClass("enable"),$("#last_month_location_bt").addClass("enable"),Z.place.length>0?T(Z.place):j(K.place))}function b(){var a=$("#event_ranking_select").val(),n=$("#event_ranking_select option:selected").data("url");ea=a,la=n,a in na?h(na[a]):n&&""!=n?v(n):u(a)}function v(a){deviceInfo.isMobile?$("head").append('<link class="past_link" rel="stylesheet" href="./contents/pastEvents/COJ-AgentLabo_files/css/ranking_mobile.css" type="text/css">'):$("head").append('<link class="past_link" rel="stylesheet" href="./contents/pastEvents/COJ-AgentLabo_files/css/ranking.css" type="text/css">'),$("#event_ranking_area").html(""),$("#event_ranking_area").load(a),$("#event_ranking_area").removeClass("display_none").addClass("display_block"),$("#actis_info").removeClass("display_block").addClass("display_none")}function u(a){J=!1;var n={uk:uk,eventId:a};$.ajax({url:"/get_event_rank",dataType:"json",data:n,type:"POST",success:function(a,n,e){J=!0,na=a.rank,h(na)},error:function(a,n,e){}})}function h(a){if(la=null,null!=a&&a.length){var n="";$("#contant_frame").scrollTop(0);for(var e=0;e<a.length;e++){var l=a[e],i="",r="",t="",o="";r=l.rank<=3?'<li class="ranking_number"></li>':deviceInfo.isMobile?'<li class="ranking_number">'+l.rank+"</li>":'<li class="ranking_number_short">'+l.rank+"</li>",l.isDisplayName||(t="font_yellow"),""!==l.codename.plateImg&&(o='<img src="'+l.codename.plateImg+'" />'),i='<div id="event_rank_'+l.rank+'" class="ranking_item"><ul>'+r+'<li class="ranking_player-name '+t+'">'+l.name+'</li><li class="ranking_code-name">'+o+'<img src="'+l.codename.textImg+'" /></li><li class="ranking_event_score">'+l.starCount+'</li><li class="ranking_region">'+l.region+'</li> <li class="ranking_place"><span>'+l.place+'</span></li> <li class="ranking_joker1 '+l["char"][1]+'"></li> <li class="ranking_joker2 '+l["char"][2]+'"></li> <li class="ranking_agent-rank" style="background:url(img/agent_rank/agent_rank_l_'+l.agentRank+'.png) no-repeat; background-size: 100%;">',l.level&&l.level>0&&(i+='<span id=rank_card_level" class="rank_card_level">'+l.level+"</span>"),i+='</li><li class="ranking_fluctuation icon_'+l.rankState+'_short"></li> </ul> </div>',n+=i}$(".past_link").remove(),$("#event_ranking_area").html("").html(n),$("#event_ranking_area").removeClass("display_none").addClass("display_block"),$("#actis_info").removeClass("display_block").addClass("display_none")}else $(".past_link").remove(),$("#actis_info").removeClass("display_none").addClass("display_block"),$("#event_ranking_area").removeClass("display_block").addClass("display_none")}function C(){J=!1,$.ajax({url:"/get_card_rank",dataType:"json",success:function(a,n,e){J=!0,V=a.cardRankInfo;var l;l=setInterval(function(){if(Object.keys(masterCard).length>0){clearInterval(l);var a="";$("#card_count_period").html("").html(V.term);for(var n=0;n<V.rank.length;n++){var e='<option value="'+n+'">'+V.rank[n].rankRange.start+"～"+V.rank[n].rankRange.end+"位 オリジナルポイント:"+V.rank[n].op+"p</option>";a+=e}$("#card_ranking_select").html("").html(a),P()}},1e3)},error:function(a,n,e){}})}function f(a){J=!1;var n={uk:uk,division:a};$.ajax({url:"/get_agent_rank",dataType:"json",data:n,type:"POST",success:function(n,e,l){J=!0;var i=[];ia=n.isRegisteredRegion,ra=n.isRegisteredPlace,a==K.national?(X.national=n.rankList,i=X.national):a==K.region?(X.region=n.rankList,i=X.region):a==K.place&&(X.place=n.rankList,i=X.place),ia&&$("#region_bt").removeClass("disable"),ra&&$("#location_bt").removeClass("disable"),x(i)},error:function(a,n,e){}})}function y(a){J=!1;var n={uk:uk,division:a};$.ajax({url:"/get_monthly_rank",dataType:"json",data:n,type:"POST",success:function(n,e,l){J=!0;var i=[];ia=n.isRegisteredRegion,ra=n.isRegisteredPlace,a==K.national?(Y.national=n.rankList,i=Y.national):a==K.region?(Y.region=n.rankList,i=Y.region):a==K.place&&(Y.place=n.rankList,i=Y.place),ia&&$("#month_region_bt").removeClass("disable"),ra&&$("#month_location_bt").removeClass("disable"),R(i)},error:function(a,n,e){}})}function j(a){J=!1;var n={uk:uk,division:a};$.ajax({url:"/get_pravious_monthly_rank",dataType:"json",data:n,type:"POST",success:function(n,e,l){J=!0;var i=[];ia=n.isRegisteredRegion,ra=n.isRegisteredPlace,a==K.national?(Z.national=n.rankList,i=Z.national):a==K.region?(Z.region=n.rankList,i=Z.region):a==K.place&&(Z.place=n.rankList,i=Z.place),ia&&$("#last_month_region_bt").removeClass("disable"),ra&&$("#last_month_location_bt").removeClass("disable"),T(i)},error:function(a,n,e){}})}function I(){J=!1,$.ajax({url:"/get_joker_rank",dataType:"json",success:function(a,n,e){J=!0,jokerMasterInfo=a.jokerMasterInfo,aa=a.rank,$("#joker_count_period").html("").html(a.term),D()},error:function(a,n,e){}})}function D(){var a="";$("#contant_frame").scrollTop(0);for(var n=0;n<aa.length;n++){var e="",l="";l=aa[n].rank<=3?'<li class="ranking_number"></li>':'<li class="ranking_number">'+aa[n].rank+"</li>",e='<div id="joker_rank_'+aa[n].rank+'" class="ranking_item"><ul>'+l+'<li class="ranking_joker-ability">'+aa[n].abilityName+'</li><li class="ranking_agent">'+aa[n].agentName+'</li><li class="ranking_op">'+aa[n].op+'p</li><li class="ranking_joker-point"><span>'+aa[n].usePoint+'</span>pt</li><li class="ranking_joker-thum" style="background-image: url(img/cards/joker/thum/joker_'+aa[n].jokerTag+'.jpg); background-size: 100%;" data-id="'+aa[n].abilityId+'"><div class="joker_char '+aa[n].charaTag+'"></div><div class="joker_no no'+aa[n].no+'"></div></li><li class="ranking_fluctuation icon_'+aa[n].rankState+'"></li></ul></div>',a+=e}$("#joker_ranking_area").html("").html(a)}function w(){var a=$(this),n=parseInt(a.attr("data-id"),10);O.jokerMasterDetailDialog(n)}function x(a){var n="";$("#contant_frame").scrollTop(0);for(var e=0;e<a.length;e++){var l=a[e],i="",r="",t="",o="",s=parseInt(l.agentRank,10);r=l.rank<=3?'<li class="ranking_number"></li>':deviceInfo.isMobile?'<li class="ranking_number">'+l.rank+"</li>":'<li class="ranking_number_short">'+l.rank+"</li>",l.isDisplayName||(o="font_yellow"),""!==l.codename.plateImg&&(t='<img src="'+l.codename.plateImg+'" />'),i='<div id="agent_rank_'+l.rank+'" class="ranking_item"><ul>'+r+'<li class="ranking_player-name '+o+'">'+l.name+'</li><li class="ranking_code-name">'+t+'<img src="'+l.codename.textImg+'" /></li>',i+=l.orb>=0&&s>=constant.league2StartId?'<li class="ranking_agent_score ranking_orb">'+l.orb+"</li>":'<li class="ranking_agent_score">'+l.agentPoint+"</li>",i+='<li class="ranking_region">'+l.region+'</li> <li class="ranking_place"><span>'+l.place+'</span></li> <li class="ranking_joker1 '+l["char"][1]+'"></li> <li class="ranking_joker2 '+l["char"][2]+'"></li> <li class="ranking_agent-rank" style="background:url(img/agent_rank/agent_rank_l_'+l.agentRank+'.png) no-repeat; background-size: 100%;">',l.level&&l.level>0&&(i+='<span id=rank_card_level" class="rank_card_level">'+l.level+"</span>"),i+='</li><li class="ranking_fluctuation icon_'+l.rankState+'_short"></li> </ul> </div>',n+=i}$("#agent_ranking_area").html("").html(n)}function R(a){var n="";if($("#contant_frame").scrollTop(0),1===q)$("#month_ranking_area").removeClass("display_block").addClass("display_none"),$("#actis_info").removeClass("display_none").addClass("display_block");else if(a.length<=0)$("#month_ranking_area").removeClass("display_block").addClass("display_none"),$("#actis_info").removeClass("display_none").addClass("display_block");else{for(var e=0;e<a.length;e++){var l=a[e],i="",r="",t="",o="";parseInt(l.agentRank,10);r=l.rank<=3?'<li class="ranking_number"></li>':deviceInfo.isMobile?'<li class="ranking_number">'+l.rank+"</li>":'<li class="ranking_number_short">'+l.rank+"</li>",l.isDisplayName||(o="font_yellow"),""!==l.codename.plateImg&&(t='<img src="'+l.codename.plateImg+'" />'),i='<div id="agent_rank_'+l.rank+'" class="ranking_item"><ul>'+r+'<li class="ranking_player-name '+o+'">'+l.name+'</li><li class="ranking_code-name">'+t+'<img src="'+l.codename.textImg+'" /></li>',i+='<li class="ranking_agent_score ranking_fame">'+l.monthlyPoint+"</li>",i+='<li class="ranking_region">'+l.region+'</li> <li class="ranking_place"><span>'+l.place+'</span></li> <li class="ranking_joker1 '+l["char"][1]+'"></li> <li class="ranking_joker2 '+l["char"][2]+'"></li> <li class="ranking_agent-rank" style="background:url(img/agent_rank/agent_rank_l_'+l.agentRank+'.png) no-repeat; background-size: 100%;">',l.level&&l.level>0&&(i+='<span id=rank_card_level" class="rank_card_level">'+l.level+"</span>"),i+='</li><li class="ranking_fluctuation icon_'+l.rankState+'_short"></li> </ul> </div>',n+=i}$("#month_ranking_area").removeClass("display_none").addClass("display_block"),$("#actis_info").removeClass("display_block").addClass("display_none"),$("#month_ranking_area").html("").html(n)}}function T(a){var n="";if($("#contant_frame").scrollTop(0),a.length<=0)$("#new_month_ranking_area").removeClass("display_block").addClass("display_none"),$("#actis_info").removeClass("display_none").addClass("display_block");else{for(var e=0;e<a.length;e++){var l=a[e],i="",r="",t="",o="";r=l.rank<=3?'<li class="ranking_number"></li>':deviceInfo.isMobile?'<li class="ranking_number">'+l.rank+"</li>":'<li class="ranking_number_short">'+l.rank+"</li>",l.isDisplayName||(o="font_yellow"),""!==l.codename.plateImg&&(t='<img src="'+l.codename.plateImg+'" />'),i='<div id="agent_rank_'+l.rank+'" class="ranking_item"><ul>'+r+'<li class="ranking_player-name '+o+'">'+l.name+'</li><li class="ranking_code-name">'+t+'<img src="'+l.codename.textImg+'" /></li>',i+='<li class="ranking_agent_score ranking_fame">'+l.monthlyPoint+"</li>",i+='<li class="ranking_region">'+l.region+'</li> <li class="ranking_place"><span>'+l.place+'</span></li> <li class="ranking_joker1 '+l["char"][1]+'"></li> <li class="ranking_joker2 '+l["char"][2]+'"></li> <li class="ranking_agent-rank" style="background:url(img/agent_rank/agent_rank_l_'+l.agentRank+'.png) no-repeat; background-size: 100%;">',l.level&&l.level>0&&(i+='<span id=rank_card_level" class="rank_card_level">'+l.level+"</span>"),i+='</li><li class="ranking_fluctuation icon_'+l.rankState+'_short"></li> </ul> </div>',n+=i}$("#new_month_ranking_area").removeClass("display_none").addClass("display_block"),$("#actis_info").removeClass("display_block").addClass("display_none"),$("#new_month_ranking_area").html("").html(n)}}function P(){var a="";$("#contant_frame").scrollTop(0);for(var n=0;n<V.rank[A].detail.length;n++){var e=V.rank[A].detail[n],l=V.rank[A].detail[n].cardId%1e4,i=masterCard[l],r="",t=(i.imgClass,"");r=e.rank<=3?'<li class="ranking_number"></li>':'<li class="ranking_number">'+e.rank+"</li>",t='<li class="ranking_card-thum" style="background-image: url('+i.s_img+');background-size: 100%;"  data-id="'+l+'"></li>';var o='<div id="card_rank_'+V.rank[A].detail[n].rank+'" class="ranking_item"><ul>'+r+'<li class="ranking_card-name">'+i.name+'</li><li class="ranking_card-type">'+constant.type[i.type].text+'</li><li class="ranking_card-attribution">'+constant.color[i.color].text+'</li><li class="ranking_card-version">'+constant.version[i.ver].text+'</li><li class="ranking_card-point"><span>'+e.usePoint+'</span>pt</li><li class="ranking_card-rate"></li>'+t+'<li class="ranking_fluctuation icon_'+e.rankState+'"></li></ul></div>';a+=o}$("#card_ranking_area").html("").html(a)}function B(){var a=$(this),n=!1,e=a.attr("data-id");F=e,O.cardDetailDialog(e,n,!1,!1)}function L(){E=!1,$("#card_detail_wrapper").removeClass("display_block").addClass("display_none")}function S(){J&&($("#actis_info").removeClass("display_block").addClass("display_none"),$("#card_ranking_area").removeClass("display_block display_none"),$("#agent_ranking_area").removeClass("display_block display_none"),$("#joker_ranking_area").removeClass("display_block display_none"),$("#event_ranking_area").removeClass("display_block display_none"),$("#month_ranking_area").removeClass("display_block display_none"),$("#new_month_ranking_area").removeClass("display_block display_none"),$("#main_wrapper").removeClass(),$(".past_link").remove(),$(this).hasClass("bt_paging_next")?z<Object.keys(Q).length?z++:z=1:z>1?z--:z=Object.keys(Q).length,$("#contant_frame").scrollTop(0),"agent_ranking"===Q[z]?($("#national_bt").addClass("enable"),$("#region_bt").removeClass("enable"),$("#location_bt").removeClass("enable"),X.national.length>0?x(X.national):f(1)):"month_ranking"===Q[z]?($("#month_national_bt").addClass("enable"),$("#month_region_bt").removeClass("enable"),$("#month_location_bt").removeClass("enable"),$("#main_wrapper").addClass(U[G]),Y.national.length>0?R(Y.national):y(1)):"last_month_ranking"===Q[z]?($("#last_month_national_bt").addClass("enable"),$("#last_month_region_bt").removeClass("enable"),$("#last_month_location_bt").removeClass("enable"),$("#main_wrapper").addClass(U[H]),Z.national.length>0?T(Z.national):j(1)):"event_ranking"===Q[z]?($("#event_ranking_select").val(ea),la&&""!=la?v(la):ea in na?h(na[ea]):u(ea)):"joker_ranking"===Q[z]&&I(),$("#main_wrapper").addClass(Q[z]))}var O=new commonClass,M=new CommonDialogClass,N=new BulletinBoardClass,z=1,A=0,E=!1,F=0,J=!1,W=new Date,q=W.getDate(),G=W.getMonth()+1,H=0;a();var K={national:1,region:2,place:3},Q={1:"card_ranking",2:"joker_ranking",3:"agent_ranking",4:"month_ranking",5:"last_month_ranking",6:"event_ranking"},U={1:"ranking_jan",2:"ranking_feb",3:"ranking_mar",4:"ranking_apr",5:"ranking_may",6:"ranking_jun",7:"ranking_jul",8:"ranking_aug",9:"ranking_sep",10:"ranking_oct",11:"ranking_nov",12:"ranking_dec"},V={},X={national:[],region:[],place:[]},Y={national:[],region:[],place:[]},Z={national:[],region:[],place:[]},aa=[],na={},ea=$("#event_ranking_select").val(),la=$("#event_ranking_select option:selected").data("url"),ia=!1,ra=!1;N.getOrderBoardInfo(),$("#card_ranking_select").change(c),$("#card_detail_image_container").on("click",k),$("#enlarge_close_bt").on("click",O.expandCardImgClose),$("#detail_virus_bt").on("click",g),$("#joker_ranking_area").on("click",".ranking_joker-thum",w),$("#top_bt").on("click",_),$("#national_bt").on("click",d),$("#region_bt").on("click",m),$("#location_bt").on("click",p),$("#month_national_bt").on("click",d),$("#month_region_bt").on("click",m),$("#month_location_bt").on("click",p),$("#last_month_national_bt").on("click",d),$("#last_month_region_bt").on("click",m),$("#last_month_location_bt").on("click",p),$("#event_ranking_select").change(b),$("#card_ranking_area").on("click",".ranking_card-thum",B),$("#card_detail_close_bt").on("click",L),$("#paging_prev_bt").on("click",S),$("#paging_next_bt").on("click",S),$("#detail_order_board_bt").on("click",n),$("#order_board_popup_cancel").on("click",N.CloseDialog),$("#bt_order_board_popup_want_normal").on("click",e),$("#bt_order_board_popup_want_foil").on("click",l),$("#bt_order_board_popup_release_normal").on("click",i),$("#bt_order_board_popup_release_foil").on("click",r),$("#common_popup_accept").on("click",t),$("#common_popup_decline").on("click",o),$("#common_popup_close").on("click",s),C()});